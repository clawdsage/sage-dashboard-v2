(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[109],{70579:function(e,t,a){Promise.resolve().then(a.bind(a,53371))},53371:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return C}});var r=a(57437),s=a(2265),n=a(6760),l=a(64608);function c(e){let{title:t,value:a,icon:s,trend:n}=e;return(0,r.jsxs)(l.Zb,{children:[(0,r.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(l.ll,{className:"text-sm font-medium",children:t}),s&&(0,r.jsx)(s,{className:"h-4 w-4 text-text-muted"})]}),(0,r.jsxs)(l.aY,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:a}),n&&(0,r.jsxs)("p",{className:"text-xs text-text-muted",children:[(0,r.jsxs)("span",{className:n.value>=0?"text-accent-green":"text-accent-red",children:[n.value>=0?"+":"",n.value,"%"]})," ",n.label]})]})]})}var i=a(35231),o=a(92566),d=a(54142),u=a(2842),x=a(9542),m=a(85475),h=a(16638);function f(e){let{data:t}=e;return(0,r.jsx)("div",{className:"w-full h-80",children:(0,r.jsx)(i.h,{width:"100%",height:"100%",children:(0,r.jsxs)(o.w,{data:t,children:[(0,r.jsx)(d.q,{strokeDasharray:"3 3",stroke:"#27272a"}),(0,r.jsx)(u.K,{dataKey:"date",stroke:"#a1a1aa",fontSize:12,tickFormatter:e=>new Date(e).toLocaleDateString()}),(0,r.jsx)(x.B,{stroke:"#a1a1aa",fontSize:12,tickFormatter:e=>"$".concat(e.toFixed(2))}),(0,r.jsx)(m.u,{contentStyle:{backgroundColor:"#1a1a1d",border:"1px solid #3f3f46",borderRadius:"6px",color:"#fafafa"},labelFormatter:e=>new Date(e).toLocaleDateString(),formatter:e=>["$".concat(e.toFixed(4)),"Cost"]}),(0,r.jsx)(h.x,{type:"monotone",dataKey:"cost",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6",strokeWidth:2,r:4},activeDot:{r:6}})]})})})}var g=a(23909),b=a(85369),j=a(68295),p=a(20153);let y=["#3b82f6","#22c55e","#f59e0b","#ef4444","#a855f7","#06b6d4"];function N(e){let{data:t}=e;return(0,r.jsx)("div",{className:"w-full h-80",children:(0,r.jsx)(i.h,{width:"100%",height:"100%",children:(0,r.jsxs)(g.u,{children:[(0,r.jsx)(b.b,{data:t,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{model:t,percent:a}=e;return"".concat(t," ").concat((100*a).toFixed(0),"%")},outerRadius:80,fill:"#8884d8",dataKey:"cost",children:t.map((e,t)=>(0,r.jsx)(j.b,{fill:y[t%y.length]},"cell-".concat(t)))}),(0,r.jsx)(m.u,{contentStyle:{backgroundColor:"#1a1a1d",border:"1px solid #3f3f46",borderRadius:"6px",color:"#fafafa"},formatter:(e,t)=>["$".concat(e.toFixed(4)),"Cost"]}),(0,r.jsx)(p.D,{wrapperStyle:{color:"#a1a1aa"},formatter:e=>(0,r.jsx)("span",{style:{color:"#fafafa"},children:e})})]})})})}var v=a(76351),w=a(44316),k=a(94207),D=a(51077),S=a(55430),O=a(40933);function C(){let[e,t]=(0,s.useState)("7d"),{data:a,isLoading:i,error:o}=function(e,t,a){let{start:r,end:s}=(()=>{let t=new Date,a=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case"today":return{start:a,end:new Date(a.getTime()+864e5)};case"7d":return{start:new Date(a.getTime()-6048e5),end:t};case"30d":return{start:new Date(a.getTime()-2592e6),end:t};default:return{start:a,end:t}}})(),n=(0,v.a)({queryKey:["analytics",e,r.toISOString(),s.toISOString()],queryFn:async()=>{let{data:e,error:t}=await w.O.from("subagent_runs").select("*").gte("started_at",r.toISOString()).lte("started_at",s.toISOString()).order("started_at",{ascending:!0});if(t)throw t;let a=e.length,n=e.reduce((e,t)=>e+(t.cost||0),0),l=e.reduce((e,t)=>e+(t.tokens_used||0),0),c=e.reduce((e,t)=>t.completed_at&&t.started_at?e+(new Date(t.completed_at).getTime()-new Date(t.started_at).getTime()):e,0),i=new Map;e.forEach(e=>{let t=e.status,a=i.get(t)||{count:0,cost:0};i.set(t,{count:a.count+1,cost:a.cost+(e.cost||0)})});let o=Array.from(i.entries()).map(e=>{let[t,a]=e;return{status:t,...a}}),d=new Map;e.forEach(e=>{let t=e.model||"unknown",a=d.get(t)||{count:0,cost:0};d.set(t,{count:a.count+1,cost:a.cost+(e.cost||0)})});let u=Array.from(d.entries()).map(e=>{let[t,a]=e;return{model:t,...a}}),x=new Map;return e.forEach(e=>{let t=new Date(e.started_at).toISOString().split("T")[0];x.set(t,(x.get(t)||0)+(e.cost||0))}),{totalRuns:a,totalCost:n,totalTokens:l,avgDuration:a>0?c/a:0,statusBreakdown:o,modelBreakdown:u,costOverTime:Array.from(x.entries()).map(e=>{let[t,a]=e;return{date:t,cost:a}}).sort((e,t)=>e.date.localeCompare(t.date)),topExpensiveRuns:e.sort((e,t)=>(t.cost||0)-(e.cost||0)).slice(0,10)}}});return{data:n.data,isLoading:n.isLoading,error:n.error}}(e);return o?(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Analytics"}),(0,r.jsx)(l.Zb,{className:"p-6",children:(0,r.jsxs)("p",{className:"text-accent-red",children:["Error loading analytics: ",o.message]})})]}):(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold",children:"Analytics"}),(0,r.jsx)("div",{className:"flex space-x-2",children:["today","7d","30d"].map(a=>(0,r.jsx)(n.z,{variant:e===a?"default":"outline",size:"sm",onClick:()=>t(a),children:"today"===a?"Today":"7d"===a?"7 Days":"30 Days"},a))})]}),i?(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,r.jsxs)(l.Zb,{className:"animate-pulse",children:[(0,r.jsx)(l.Ol,{className:"pb-2",children:(0,r.jsx)("div",{className:"h-4 bg-bg-tertiary rounded"})}),(0,r.jsxs)(l.aY,{children:[(0,r.jsx)("div",{className:"h-8 bg-bg-tertiary rounded mb-2"}),(0,r.jsx)("div",{className:"h-3 bg-bg-tertiary rounded"})]})]},t))}):a?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[(0,r.jsx)(c,{title:"Total Runs",value:a.totalRuns,icon:k.Z}),(0,r.jsx)(c,{title:"Total Cost",value:"$".concat(a.totalCost.toFixed(4)),icon:D.Z}),(0,r.jsx)(c,{title:"Total Tokens",value:a.totalTokens.toLocaleString(),icon:S.Z}),(0,r.jsx)(c,{title:"Avg Duration",value:"".concat((a.avgDuration/1e3).toFixed(1),"s"),icon:O.Z})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[(0,r.jsxs)(l.Zb,{children:[(0,r.jsx)(l.Ol,{children:(0,r.jsx)(l.ll,{children:"Cost Over Time"})}),(0,r.jsx)(l.aY,{children:(0,r.jsx)(f,{data:a.costOverTime})})]}),(0,r.jsxs)(l.Zb,{children:[(0,r.jsx)(l.Ol,{children:(0,r.jsx)(l.ll,{children:"Cost by Model"})}),(0,r.jsx)(l.aY,{children:(0,r.jsx)(N,{data:a.modelBreakdown})})]})]}),(0,r.jsxs)(l.Zb,{children:[(0,r.jsx)(l.Ol,{children:(0,r.jsx)(l.ll,{children:"Top 10 Most Expensive Runs"})}),(0,r.jsx)(l.aY,{children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b border-border-subtle",children:[(0,r.jsx)("th",{className:"text-left py-2",children:"Name"}),(0,r.jsx)("th",{className:"text-left py-2",children:"Model"}),(0,r.jsx)("th",{className:"text-left py-2",children:"Status"}),(0,r.jsx)("th",{className:"text-right py-2",children:"Cost"}),(0,r.jsx)("th",{className:"text-right py-2",children:"Tokens"}),(0,r.jsx)("th",{className:"text-right py-2",children:"Duration"})]})}),(0,r.jsx)("tbody",{children:a.topExpensiveRuns.map(e=>{var t;return(0,r.jsxs)("tr",{className:"border-b border-border-subtle",children:[(0,r.jsx)("td",{className:"py-2",children:e.name}),(0,r.jsx)("td",{className:"py-2",children:e.model||"N/A"}),(0,r.jsx)("td",{className:"py-2",children:(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("completed"===e.status?"bg-accent-green/20 text-accent-green":"failed"===e.status?"bg-accent-red/20 text-accent-red":"bg-accent-amber/20 text-accent-amber"),children:e.status})}),(0,r.jsxs)("td",{className:"text-right py-2",children:["$",(e.cost||0).toFixed(4)]}),(0,r.jsx)("td",{className:"text-right py-2",children:(null===(t=e.tokens_total)||void 0===t?void 0:t.toLocaleString())||0}),(0,r.jsx)("td",{className:"text-right py-2",children:e.duration_ms?"".concat((e.duration_ms/1e3).toFixed(1),"s"):"N/A"})]},e.id)})})]})})})]})]}):(0,r.jsxs)(l.Zb,{className:"p-12 text-center",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No data available"}),(0,r.jsx)("p",{className:"text-text-muted",children:"Run some agents to see analytics here."})]})]})}},6760:function(e,t,a){"use strict";a.d(t,{z:function(){return i}});var r=a(57437),s=a(2265),n=a(13027),l=a(49354);let c=(0,n.j)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-bg-primary",{variants:{variant:{default:"bg-accent-blue text-white hover:bg-accent-blue/80",secondary:"bg-bg-tertiary text-text-primary hover:bg-bg-tertiary/80",outline:"border border-border-default bg-transparent text-text-primary hover:bg-bg-tertiary",ghost:"bg-transparent text-text-primary hover:bg-bg-tertiary",success:"bg-accent-green text-white hover:bg-accent-green/80",danger:"bg-accent-red text-white hover:bg-accent-red/80"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),i=(0,s.forwardRef)((e,t)=>{let{className:a,variant:s,size:n,asChild:i=!1,...o}=e;return(0,r.jsx)("button",{className:(0,l.cn)(c({variant:s,size:n,className:a})),ref:t,...o})});i.displayName="Button"},64608:function(e,t,a){"use strict";a.d(t,{Ol:function(){return c},Zb:function(){return l},aY:function(){return o},ll:function(){return i}});var r=a(57437),s=a(2265),n=a(49354);let l=(0,s.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border border-border-subtle bg-bg-secondary text-text-primary shadow-sm",a),...s})});l.displayName="Card";let c=(0,s.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...s})});c.displayName="CardHeader";let i=(0,s.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});i.displayName="CardTitle",(0,s.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-text-muted",a),...s})}).displayName="CardDescription";let o=(0,s.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...s})});o.displayName="CardContent",(0,s.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter"},44316:function(e,t,a){"use strict";a.d(t,{O:function(){return r}});let r=(0,a(17327).eI)("https://kunkqedkkpwaspsucytj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt1bmtxZWRra3B3YXNwc3VjeXRqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk3Mzg4MTgsImV4cCI6MjA4NTMxNDgxOH0.gLXr1NCOSaLKGySozsDKJucOhtEDrm1OOfmbj7Z7-1o")},49354:function(e,t,a){"use strict";a.d(t,{SY:function(){return c},aF:function(){return i},cn:function(){return n},p6:function(){return l}});var r=a(44839),s=a(96164);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.m6)((0,r.W)(t))}function l(e){return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(new Date(e))}function c(e){let t=new Date,a=new Date(e),r=Math.floor((t.getTime()-a.getTime())/1e3);return r<60?"just now":r<3600?"".concat(Math.floor(r/60),"m ago"):r<86400?"".concat(Math.floor(r/3600),"h ago"):"".concat(Math.floor(r/86400),"d ago")}function i(e,t){return e.length<=t?e:e.slice(0,t)+"..."}}},function(e){e.O(0,[289,176,784,971,23,744],function(){return e(e.s=70579)}),_N_E=e.O()}]);